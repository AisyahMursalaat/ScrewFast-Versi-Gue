---
import MainLayout from "@/layouts/MainLayout.astro";
const pageTitle = "Katalog Unit | RentHeavyPro";
---

<MainLayout title={pageTitle}>
  <div class="mx-auto max-w-[85rem] px-4 py-10 lg:py-14">
    <div class="text-center mb-10">
      <h2 class="text-3xl font-bold text-gray-800 dark:text-white">Katalog Armada (XAMPP)</h2>
      <p class="text-gray-500 mt-2">Unit terawat, siap kerja. Data Real-time dari Database Server.</p>
      
      <div class="mt-6 flex flex-col sm:flex-row justify-center gap-4">
         <input type="text" id="searchInput" placeholder="üîç Cari nama alat (misal: Excavator)..." class="border p-3 rounded-lg w-full sm:w-64 shadow-sm outline-none focus:ring-2 focus:ring-orange-500">
         
         <select id="catFilter" class="border p-3 rounded-lg shadow-sm focus:ring-2 focus:ring-orange-500 outline-none bg-white">
            <option value="all">Semua Kategori</option>
            <option value="Heavy">Heavy Duty (Berat)</option>
            <option value="Light">Light Duty (Ringan)</option>
         </select>

         <select id="priceFilter" class="border p-3 rounded-lg shadow-sm focus:ring-2 focus:ring-orange-500 outline-none bg-white">
            <option value="default">Urutkan Harga</option>
            <option value="low">Termurah</option>
            <option value="high">Termahal</option>
         </select>
      </div>
    </div>

    <div id="productGrid" class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
       <div class="col-span-full text-center py-10 text-gray-500">
          <span class="animate-pulse">‚è≥ Menghubungkan ke Server (Port 5000)...</span>
       </div>
    </div>
    
    <div id="emptyMsg" class="hidden col-span-full text-center py-10 text-gray-400">
       Tidak ada unit yang cocok dengan pencarian.
    </div>
  </div>

  <div id="rentModal" class="fixed inset-0 z-[999] hidden bg-black/60 flex items-center justify-center p-4 overflow-y-auto">
     <div class="bg-white w-full max-w-lg rounded-xl p-6 dark:bg-neutral-900 my-8 shadow-2xl transition-all transform scale-100">
        
        <div class="flex justify-between items-center mb-6 border-b pb-4">
            <div>
               <h3 class="font-bold text-xl text-gray-800 dark:text-white">Sewa Unit</h3>
               <p class="text-xs text-gray-500">ID Unit: <span id="mIdDisplay">#</span></p>
            </div>
            <button id="closeModal" class="text-gray-500 hover:text-red-500 text-2xl">&times;</button>
        </div>

        <div class="flex items-center gap-4 mb-6 bg-blue-50 p-3 rounded border border-blue-100">
           <div id="mIcon" class="text-4xl">üöú</div>
           <div>
              <h4 id="mName" class="font-bold text-gray-800">Nama Unit</h4>
              <p id="mPrice" class="text-sm text-orange-600 font-bold">Rp 0 / hari</p>
              <input type="hidden" id="mPriceRaw">
              <input type="hidden" id="mProductId">
           </div>
        </div>

        <div class="flex justify-between text-xs font-bold text-gray-400 border-b pb-3 mb-5">
           <span id="stepLabel1" class="text-blue-600 border-b-2 border-blue-600 pb-1 transition-colors">1. Detail Sewa</span>
           <span id="stepLabel2" class="transition-colors">2. Legalitas</span>
           <span id="stepLabel3" class="transition-colors">3. Pembayaran</span>
        </div>
        
        <form id="rentalForm">
            
            <div id="step1" class="space-y-4">
               <div>
                  <label class="block text-xs font-bold text-gray-500 mb-1">Nama Penyewa / Perusahaan</label>
                  <input id="inpName" type="text" class="w-full border p-2.5 rounded focus:ring-2 focus:ring-blue-500 outline-none" placeholder="Nama Lengkap" required>
               </div>
               <div>
                  <label class="block text-xs font-bold text-gray-500 mb-1">Lokasi Proyek</label>
                  <textarea id="inpAddr" class="w-full border p-2.5 rounded focus:ring-2 focus:ring-blue-500 outline-none" rows="2" placeholder="Alamat Lengkap Proyek" required></textarea>
               </div>
               <div>
                  <label class="block text-xs font-bold text-gray-500 mb-1">Kuantitas Unit</label>
                  <input id="inpQty" type="number" value="1" min="1" class="w-full border p-2.5 rounded focus:ring-2 focus:ring-blue-500 outline-none" required>
               </div>
               
               <div class="grid grid-cols-2 gap-3">
                  <div>
                     <label class="block text-xs font-bold text-gray-500 mb-1">Mulai Tanggal</label>
                     <input id="inpDate" type="date" class="w-full border p-2.5 rounded" required>
                  </div>
                  <div>
                     <label class="block text-xs font-bold text-gray-500 mb-1">Durasi Sewa</label>
                     <div class="flex">
                         <input id="inpDur" type="number" value="1" min="1" class="w-16 border p-2.5 rounded-l text-center outline-none" required>
                         <select id="inpType" class="w-full border p-2.5 rounded-r bg-gray-50 text-sm font-bold outline-none">
                            <option value="Hari">Hari</option>
                            <option value="Jam">Jam (Min 50)</option>
                            <option value="Bulan">Bulan (Disc 10%)</option>
                            <option value="Tahun">Tahun (Disc 30%)</option>
                         </select>
                     </div>
                  </div>
               </div>
               
               <div class="bg-gray-50 p-3 rounded text-right border border-gray-200">
                  <p class="text-xs text-gray-500">Estimasi Biaya Sewa:</p>
                  <span id="rentalTxt" class="font-bold text-lg text-blue-700">Rp 0</span>
                  <p id="discountInfo" class="text-xs text-green-600 font-bold mt-1 hidden">Hemat: Rp 0</p>
                  <div class="border-t border-gray-300 mt-2 pt-2">
                     <p class="text-xs text-gray-500">Biaya Logistik:</p>
                     <p id="logisticTxt" class="font-bold text-blue-700">Rp 0</p>
                  </div>
                  <div class="border-t border-gray-300 mt-2 pt-2">
                     <p class="text-xs text-gray-500">Total Estimasi:</p>
                     <span id="totalTxt" class="font-bold text-xl text-orange-600">Rp 0</span>
                  </div>
               </div>

               <button type="button" onclick="nextStep(2)" class="w-full bg-black text-white font-bold py-3 rounded-lg hover:bg-gray-900 transition mt-2 shadow-md">Lanjut: Upload Dokumen</button>
            </div>

            <div id="step2" class="hidden space-y-4">
               <div class="bg-yellow-50 p-3 rounded border border-yellow-200 text-sm text-yellow-800 flex items-start gap-2">
                 <span>‚ö†Ô∏è</span>
                 <div><b>Syarat Wajib:</b> Upload Foto SIM B2 Umum / SIO Operator yang masih berlaku.</div>
               </div>
               
               <div class="border-2 border-dashed border-gray-300 p-8 rounded-xl text-center cursor-pointer hover:bg-gray-50 transition relative group">
                 <input type="file" id="inpFile" class="absolute inset-0 opacity-0 cursor-pointer" accept="image/*,.pdf" required>
                 <div id="filePreview">
                    <div class="text-4xl mb-2 group-hover:scale-110 transition">üìÇ</div>
                    <p class="text-sm font-bold text-gray-600">Klik untuk Upload Dokumen</p>
                    <p class="text-xs text-gray-400">Format: JPG, PNG, PDF (Max 5MB)</p>
                 </div>
               </div>

               <div class="space-y-3 mt-4">
                  <label class="flex items-start gap-2 cursor-pointer">
                     <input type="checkbox" id="chkTerms1" class="mt-1">
                     <span class="text-xs text-gray-600">Saya menyetujui di RentHeavyPro Syarat dan Ketentuan</span>
                  </label>
                  <label class="flex items-start gap-2 cursor-pointer">
                     <input type="checkbox" id="chkTerms2" class="mt-1">
                     <span class="text-xs text-gray-600">Saya telah membaca dan menyetujui syarat dan ketentuan yang berlaku di RentHeavyPro.</span>
                  </label>
               </div>

               <div class="flex gap-3 pt-4">
                  <button type="button" onclick="nextStep(1)" class="w-1/3 bg-gray-200 font-bold py-3 rounded-lg hover:bg-gray-300 transition">Kembali</button>
                  <button type="button" id="btnContinuePayment" onclick="nextStep(3)" class="w-2/3 bg-black text-white font-bold py-3 rounded-lg hover:bg-gray-900 transition shadow-md disabled:opacity-50 disabled:cursor-not-allowed" disabled>Lanjut Pembayaran</button>
               </div>
            </div>

            <div id="step3" class="hidden space-y-4 text-center">
               <h4 class="font-bold text-gray-700 mb-2">Pilih Metode Pembayaran</h4>
               
               <div class="grid grid-cols-2 gap-3 text-left">
                  <div class="pay-method border p-3 rounded-lg cursor-pointer hover:border-blue-500 bg-blue-50 transition"><p class="font-bold text-blue-800">BCA</p><p class="text-xs text-gray-500">Virtual Account</p></div>
                  <div class="pay-method border p-3 rounded-lg cursor-pointer hover:border-blue-500 bg-yellow-50 transition"><p class="font-bold text-yellow-600">Mandiri</p><p class="text-xs text-gray-500">Bill Payment</p></div>
                  <div class="pay-method border p-3 rounded-lg cursor-pointer hover:border-blue-500 bg-orange-50 transition"><p class="font-bold text-orange-600">BNI</p><p class="text-xs text-gray-500">Virtual Account</p></div>
                  <div class="pay-method border p-3 rounded-lg cursor-pointer hover:border-blue-500 bg-gray-50 transition"><p class="font-bold text-gray-800">QRIS</p><p class="text-xs text-gray-500">Scan & Pay</p></div>
               </div>
               
               <div id="paymentProcess" class="hidden mt-6 p-5 bg-gray-100 rounded-xl border border-gray-200">
                  <div id="spinner" class="animate-spin text-3xl mb-2">üîÑ</div>
                  <p id="payStatusText" class="text-sm font-bold text-gray-600">Menghubungkan Payment Gateway...</p>
                  
                  <div id="vaResult" class="hidden mt-3">
                      <p class="text-xs text-gray-500">Nomor Virtual Account:</p>
                      <p class="text-2xl font-mono font-bold text-gray-800 tracking-widest my-2">8800 1234 5678</p>
                  </div>
               </div>

               <div class="flex gap-3 mt-6">
                  <button type="button" id="btnBack3" onclick="nextStep(2)" class="w-1/3 bg-gray-200 font-bold py-3 rounded-lg hover:bg-gray-300 transition">Kembali</button>
                  <button type="submit" id="btnFinalPay" class="w-2/3 bg-black text-white font-bold py-3 rounded-lg hover:bg-gray-900 transition shadow-md hidden">Saya Sudah Bayar</button>
               </div>
            </div>
        </form>
     </div>
  </div>

  {/* Modal untuk Perjanjian Lengkap */}
  <div id="termsModal" class="fixed inset-0 z-[9999] hidden bg-black/60 flex items-center justify-center p-4">
    <div class="bg-white w-full max-w-2xl rounded-xl p-6 dark:bg-neutral-900 shadow-2xl max-h-[90vh] overflow-y-auto">
      <div class="flex justify-between items-center mb-4 sticky top-0 bg-white dark:bg-neutral-900">
        <h2 class="text-xl font-bold text-gray-800 dark:text-white">Perjanjian Sewa-Menyewa Alat Berat</h2>
        <button type="button" onclick="closeTermsModal()" class="text-gray-500 hover:text-red-500 text-2xl">&times;</button>
      </div>
      
      <div id="termsContent" class="text-sm text-gray-700 dark:text-gray-300 space-y-4 leading-relaxed mb-6">
        {/* Terms akan dimuat dari JavaScript */}
      </div>

      <div class="flex gap-3 sticky bottom-0 bg-white dark:bg-neutral-900 pt-4 border-t">
        <button type="button" onclick="closeTermsModal()" class="w-full bg-gray-200 font-bold py-2 rounded-lg hover:bg-gray-300 transition">Tutup</button>
        <button type="button" onclick="acceptTermsModal()" class="w-full bg-blue-600 text-white font-bold py-2 rounded-lg hover:bg-blue-700 transition">Saya Setuju</button>
      </div>
    </div>
  </div>

  <script>
    const API_URL = 'http://localhost:5000/api';
    const UPLOAD_URL = 'http://localhost:5000/uploads';

    let allProducts = [];

    // 1. FETCH DATA DARI DATABASE XAMPP (PB-01)
    async function loadProducts() {
       try {
          const res = await fetch(`${API_URL}/products`);
          if (!res.ok) throw new Error('Server Error');
          allProducts = await res.json();
          renderGrid(allProducts);
       } catch (e) {
          document.getElementById('productGrid').innerHTML = `
            <div class="col-span-full text-center py-10 bg-red-50 rounded-xl border border-red-200">
                <p class="text-red-600 font-bold">Gagal terhubung ke Server Backend (Port 5000)</p>
                <p class="text-sm text-red-400">Pastikan terminal "node server.js" sudah dijalankan.</p>
            </div>`;
       }
    }

    // Render Grid Produk
    function renderGrid(data) {
        const grid = document.getElementById('productGrid');
        const emptyMsg = document.getElementById('emptyMsg');

        if(data.length === 0) { 
            grid.classList.add('hidden'); 
            emptyMsg.classList.remove('hidden'); 
            return; 
        }
        
        grid.classList.remove('hidden');
        emptyMsg.classList.add('hidden');
        
        grid.innerHTML = data.map(p => {
            // Cek gambar (Emoji vs File URL)
            const imgHTML = (p.image && p.image.length < 5) 
                ? `<div class="text-6xl">${p.image}</div>` 
                : `<img src="${p.image.startsWith('http') ? p.image : UPLOAD_URL + '/' + p.image}" class="w-full h-full object-cover">`;

            return `
             <div class="border rounded-xl overflow-hidden shadow-sm bg-white hover:shadow-lg transition dark:bg-neutral-900 dark:border-neutral-700 group overflow-hidden">
                <div class="h-52 bg-gray-100 flex items-center justify-center group-hover:scale-105 transition duration-300 relative">
                    ${imgHTML}
                    <span class="absolute top-3 right-3 bg-black/70 text-white text-xs px-2 py-1 rounded">${p.category || 'Heavy'}</span>
                </div>
                <div class="p-5">
                   <h3 class="font-bold text-lg text-gray-800 dark:text-white mb-1">${p.name}</h3>
                   <p class="text-sm text-gray-500 line-clamp-2">${p.description || 'Ready unit.'}</p>
                   
                   <div class="flex justify-between items-end mt-4">
                       <div>
                           <p class="text-xs text-gray-400">Harga Sewa</p>
                           <p class="text-orange-600 font-bold text-xl">Rp ${parseInt(p.price).toLocaleString()}<span class="text-xs text-gray-500 font-normal">/hari</span></p>
                       </div>
                       <button onclick="openModal(${p.id}, '${p.name}', ${p.price}, '${p.image}')" class="bg-gray-900 text-white px-5 py-2.5 rounded-lg text-sm font-bold hover:bg-gray-800 transition shadow-md">Sewa</button>
                   </div>
                </div>
             </div>
        `}).join('');
    }

    // --- PB-02: FILTER & SEARCH ---
    function filterProducts() {
        const term = document.getElementById('searchInput').value.toLowerCase();
        const cat = document.getElementById('catFilter').value;
        const sort = document.getElementById('priceFilter').value;
        
        let filtered = allProducts.filter(p => {
            const matchName = p.name.toLowerCase().includes(term);
            const matchCat = cat === 'all' || p.category === cat;
            return matchName && matchCat;
        });

        if (sort === 'low') filtered.sort((a, b) => a.price - b.price);
        if (sort === 'high') filtered.sort((a, b) => b.price - a.price);

        renderGrid(filtered);
    }
    document.getElementById('searchInput').addEventListener('input', filterProducts);
    document.getElementById('catFilter').addEventListener('change', filterProducts);
    document.getElementById('priceFilter').addEventListener('change', filterProducts);

    // --- LOGIKA MODAL & WIZARD ---
    const modal = document.getElementById('rentModal');
    const inpDur = document.getElementById('inpDur');
    const inpType = document.getElementById('inpType');
    const inpQty = document.getElementById('inpQty');
    const totalTxt = document.getElementById('totalTxt');
    const mPriceRaw = document.getElementById('mPriceRaw');
    const mProductId = document.getElementById('mProductId');
    const discountInfo = document.getElementById('discountInfo');

    window.openModal = (id, name, price, img) => {
       // Cek Login (PB-03)
       if (localStorage.getItem('isLoggedIn') !== 'true') {
           if(confirm('Silakan Login terlebih dahulu untuk menyewa unit.')) window.location.href = '/login';
           return;
       }

       document.getElementById('mName').innerText = name;
       document.getElementById('mPrice').innerText = `Rp ${parseInt(price).toLocaleString()} / hari`;
       document.getElementById('mIdDisplay').innerText = `#${id}`;
       
       const iconEl = document.getElementById('mIcon');
       if(img.length < 5) iconEl.innerHTML = img; 
       else iconEl.innerHTML = `<img src="${img.startsWith('http') ? img : UPLOAD_URL + '/' + img}" class="w-12 h-12 object-cover rounded">`;

       mPriceRaw.value = price;
       mProductId.value = id;
       
       // Reset Form
       document.getElementById('rentalForm').reset();
       document.getElementById('inpName').value = localStorage.getItem('username') || '';
       document.getElementById('filePreview').innerHTML = '<div class="text-4xl mb-2">üìÇ</div><p class="text-sm font-bold text-gray-600">Klik Upload Dokumen</p>';
       document.getElementById('paymentProcess').classList.add('hidden');
       document.getElementById('btnFinalPay').classList.add('hidden');
       document.getElementById('btnBack3').classList.remove('hidden');
       
       inpQty.value = 1;
       inpType.value = "Hari"; 
       inpDur.value = 1;
       
       nextStep(1);
       modal.classList.remove('hidden');
       calculateTotal();
    };

    document.getElementById('closeModal').onclick = () => modal.classList.add('hidden');

    // Navigasi Step
    window.nextStep = (step) => {
        [1,2,3].forEach(n => document.getElementById(`step${n}`).classList.add('hidden'));
        document.getElementById(`step${step}`).classList.remove('hidden');
        [1,2,3].forEach(n => {
            const lbl = document.getElementById(`stepLabel${n}`);
            lbl.classList.remove('text-blue-600', 'border-b-2', 'border-blue-600');
            if(n <= step) lbl.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
        });
    };

    // Kalkulator
    function calculateTotal() {
       const p = parseInt(mPriceRaw.value);
       let d = parseInt(inpDur.value);
       const t = inpType.value;
       const q = parseInt(inpQty.value) || 1;
       let rentalTotal = 0, normalTotal = 0;

       if(t === 'Jam') {
          rentalTotal = (p / 8) * d * q;
          discountInfo.classList.add('hidden');
       } else if(t === 'Hari') {
          rentalTotal = p * d * q;
          discountInfo.classList.add('hidden');
       } else if(t === 'Bulan') {
          normalTotal = (p * 30) * d * q;
          rentalTotal = normalTotal * 0.9; 
          discountInfo.innerText = `Hemat: Rp ${(normalTotal - rentalTotal).toLocaleString()} (Disc 10%)`;
          discountInfo.classList.remove('hidden');
       } else if(t === 'Tahun') {
          normalTotal = (p * 365) * d * q;
          rentalTotal = normalTotal * 0.7;
          discountInfo.innerText = `Hemat: Rp ${(normalTotal - rentalTotal).toLocaleString()} (Disc 30%)`;
          discountInfo.classList.remove('hidden');
       }
       
       // Hitung biaya logistik (15% dari rental total)
       const logisticFee = rentalTotal * 0.15;
       const grandTotal = rentalTotal + logisticFee;
       
       document.getElementById('rentalTxt').innerText = `Rp ${parseInt(rentalTotal).toLocaleString()}`;
       document.getElementById('logisticTxt').innerText = `Rp ${parseInt(logisticFee).toLocaleString()}`;
       document.getElementById('totalTxt').innerText = `Rp ${parseInt(grandTotal).toLocaleString()}`;
    }

    inpDur.addEventListener('input', calculateTotal);
    inpQty.addEventListener('input', calculateTotal);
    inpType.addEventListener('change', () => {
        if(inpType.value === 'Jam') { inpDur.value = 50; alert('‚ÑπÔ∏è Sewa Per Jam: Minimal 50 Jam'); }
        else { inpDur.value = 1; }
        calculateTotal();
    });
    inpDur.addEventListener('change', () => {
       if(inpType.value === 'Jam' && parseInt(inpDur.value) < 50) {
          inpDur.value = 50;
          calculateTotal();
       }
    });

    // File Preview
    document.getElementById('inpFile').addEventListener('change', function() {
        if(this.files[0]) {
            document.getElementById('filePreview').innerHTML = `<div class="text-4xl mb-2 text-green-500">‚úÖ</div><p class="font-bold text-green-700">${this.files[0].name}</p>`;
        }
    });

    // Payment Simulation
    document.querySelectorAll('.pay-method').forEach(btn => {
        btn.addEventListener('click', () => {
            document.getElementById('paymentProcess').classList.remove('hidden');
            document.getElementById('spinner').classList.remove('hidden');
            document.getElementById('payStatusText').innerText = "Menghubungkan ke Payment Gateway...";
            document.getElementById('vaResult').classList.add('hidden');
            document.getElementById('btnFinalPay').classList.add('hidden');

            setTimeout(() => {
                document.getElementById('spinner').classList.add('hidden');
                document.getElementById('payStatusText').innerText = "Silakan Transfer ke:";
                document.getElementById('vaResult').classList.remove('hidden');
                document.getElementById('btnFinalPay').classList.remove('hidden');
                document.getElementById('vaNumber').innerText = "8800 " + Math.floor(10000000 + Math.random() * 90000000);
            }, 2000);
        });
    });

    // --- 3. SUBMIT KE BACKEND (XAMPP) ---
    document.getElementById('rentalForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const btn = document.getElementById('btnFinalPay');
        btn.innerText = "Memproses Order...";
        btn.disabled = true;

        const formData = new FormData();
        formData.append('customer_name', document.getElementById('inpName').value);
        formData.append('project_loc', document.getElementById('inpAddr').value);
        formData.append('product_id', mProductId.value);
        formData.append('start_date', document.getElementById('inpDate').value);
        formData.append('duration', `${inpDur.value} ${inpType.value}`);
        formData.append('total_rental_fee', document.getElementById('totalTxt').innerText.replace(/[Rp,.]/g, '').trim());
        
        // TAMBAHKAN USER ID (PENTING BUAT DASHBOARD USER)
        formData.append('user_id', localStorage.getItem('userId'));

        const fileInput = document.getElementById('inpFile');
        if(fileInput.files[0]) formData.append('sim_document', fileInput.files[0]);

        try {
            const res = await fetch(`${API_URL}/checkout`, { method: 'POST', body: formData });
            const result = await res.json();
            
            if(result.success) {
                alert(`‚úÖ PEMBAYARAN BERHASIL!\nID Order: ${result.orderId}\nStatus: Menunggu Verifikasi Admin.`);
                modal.classList.add('hidden');
                // Redirect ke Dashboard User
                window.location.href = '/dashboard';
            } else {
                alert('Gagal: ' + result.message);
            }
        } catch (err) {
            console.error(err);
            alert('Terjadi kesalahan koneksi ke server.');
        }
        btn.disabled = false;
        btn.innerText = "Saya Sudah Bayar";
    });

    loadProducts();

    // --- TERMS & CONDITIONS MODAL ---
    const termsText = `PERJANJIAN SEWA-MENYEWA ALAT BERAT (PT RENTHEAVYPRO)

PT RentHeavyPro (selanjutnya disebut "PENYEDIA") dan Pelanggan (selanjutnya disebut "CUSTOMER") dengan ini menyatakan bahwa CUSTOMER akan menyewa alat berat atau unit (selanjutnya disebut "Unit") dari PENYEDIA melalui Aplikasi RentHeavyPro (selanjutnya disebut "Reservasi"). PENYEDIA dengan ini pula menyatakan persetujuannya untuk menyewakan Unit kepada CUSTOMER, dengan syarat dan ketentuan sebagai berikut:

PASAL 1 ‚Äì KETENTUAN UMUM
Sewa Unit Alat Berat adalah layanan sewa Unit untuk pemakaian harian, mingguan, bulanan, atau tahunan. Layanan ini umumnya bersifat Lepas Kunci (Self-Operated) oleh operator CUSTOMER.

CUSTOMER wajib melengkapi dokumen-dokumen kelengkapan, terutama legalitas Operator (berupa Surat Izin Operator (SIO) atau SIM B2 Umum yang masih berlaku), sebagaimana dipersyaratkan oleh PENYEDIA pada saat melakukan Reservasi.

CUSTOMER wajib menunjukkan bukti Reservasi dan identitas (KTP/Paspor/ID Card) asli pada saat serah terima, sesuai dengan dokumen yang diberikan kepada pihak PENYEDIA.

Apabila Unit Pengganti Sementara diperjanjikan dalam Perjanjian, maka jika Unit mengalami kerusakan yang tidak disebabkan oleh CUSTOMER dan membutuhkan jangka waktu perbaikan yang signifikan, PENYEDIA akan secepatnya menyediakan Unit Pengganti Sementara kepada CUSTOMER tanpa biaya tambahan, sepanjang kerusakan itu terjadi di wilayah operasional yang terjangkau. Unit Pengganti Sementara merupakan unit setipe/sekelas atau yang tersedia, serta dalam keadaan baik dan layak jalan.

PASAL 2 ‚Äì MASA SEWA
CUSTOMER dapat menggunakan Unit terhitung sejak tanggal yang tercantum dalam Reservasi sampai dengan berakhirnya seluruh Reservasi yang dibuatkan oleh CUSTOMER.

PASAL 3 ‚Äì RESERVASI DAN PEMBATALAN
CUSTOMER dapat melakukan Reservasi atas penggunaan Unit melalui Aplikasi, atau Call Center, atau email, atau pemesanan langsung di Kantor Cabang PENYEDIA.

CUSTOMER dapat melakukan perubahan durasi sewa Unit atau membatalkan Reservasi, dengan syarat pembatalan atau perubahan dilakukan paling lambat 24 (dua puluh empat) jam sebelum Masa Sewa dimulai.

PASAL 4 ‚Äì TATA CARA PEMBAYARAN
Semua biaya sewa ("Biaya Sewa") akan dibayar dimuka oleh CUSTOMER sesuai dengan nominal Total Tagihan Penuh yang tertera pada Reservasi.

Biaya-biaya tambahan yang muncul kemudian (misalnya Biaya Overtime, Kerusakan Klaim Asuransi Risiko Sendiri, atau Biaya Demobilisasi Mendadak) akan ditagih secara terpisah dan wajib dibayar selambat-lambatnya sebelum Masa Sewa berakhir.

Pembayaran Biaya Sewa dan biaya tambahan akan dilakukan oleh CUSTOMER melalui transfer bank ke rekening milik PT RentHeavyPro sebagaimana ditentukan melalui dokumen tagihan.

Kelengkapan dokumen tagihan meliputi: Invoice (Asli), Purchase Order (PO)/Dokumen Reservasi dari CUSTOMER, Lembar Pemeriksaan (Checklist) pada saat serah terima, dan Faktur Pajak (jika diperlukan).

Dalam hal perpanjangan Masa Sewa, CUSTOMER wajib menyerahkan biaya perpanjangan Masa Sewa, setelah menginformasikan kepada PENYEDIA dan tetap memperhatikan ketersediaan Unit.

PASAL 5 ‚Äì PERUBAHAN DAN PENGAKHIRAN MASA SEWA
CUSTOMER wajib mengkonfirmasikan perpanjangan Masa Sewa kepada PENYEDIA paling lambat 1 (satu) hari sebelum Masa Sewa berakhir.

Dalam hal CUSTOMER melakukan Pengakhiran Masa Sewa sebelum berakhirnya Masa Sewa ("Pengakhiran Masa Sewa Dipercepat"):

Jika Pengakhiran Masa Sewa Dipercepat dilakukan saat Masa Sewa berjalan, maka Biaya Sewa yang telah dibayarkan tidak dapat dikembalikan.

Jika Pengakhiran Masa Sewa Dipercepat dilakukan sebelum Masa Sewa berjalan (Pembatalan Dini), maka PENYEDIA akan mengembalikan Biaya Sewa (refund) sesuai kebijakan pembatalan yang berlaku.

PENYEDIA berhak mengakhiri Masa Sewa tanpa pemberitahuan terlebih dahulu apabila CUSTOMER melanggar ketentuan dalam Perjanjian ini atau terjadi penyalahgunaan Unit.

PASAL 6 ‚Äì KEWAJIBAN DAN TANGGUNG JAWAB CUSTOMER
CUSTOMER dilarang keras mengalihkan, menyewakan lebih lanjut, atau menjaminkan (agunan) Unit kepada Pihak lain.

CUSTOMER bertanggung jawab penuh atas pengoperasian Unit dan wajib memastikan bahwa Unit hanya dioperasikan oleh Operator yang memiliki legalitas sesuai (SIO/SIM B2 Umum) dan sesuai dengan prosedur K3 (Keselamatan dan Kesehatan Kerja).

CUSTOMER dilarang menggunakan Unit untuk tujuan melanggar hukum, kampanye politik, atau aktivitas lain yang dapat merusak citra PENYEDIA.

CUSTOMER wajib menanggung semua biaya operasional di lokasi proyek, termasuk namun tidak terbatas pada bahan bakar, biaya tol, retribusi, dan biaya parkir.

Apabila terjadi kehilangan, kerusakan, atau perubahan pada Unit atau perlengkapannya yang disebabkan oleh kelalaian CUSTOMER, CUSTOMER bertanggung jawab penuh untuk mengganti seluruh kerugian yang dialami oleh PENYEDIA.

Segala risiko dan biaya yang timbul sebagai pelanggaran terhadap Pasal ini menjadi tanggung jawab CUSTOMER.

PASAL 7 ‚Äì ASURANSI UNIT
Semua Unit PENYEDIA telah diasuransikan kepada Perusahaan Asuransi yang ditunjuk oleh PENYEDIA dengan Asuransi Comprehensive/All Risk sesuai dengan ketentuan yang tercantum dalam polis asuransi.

Proteksi asuransi dimulai ketika CUSTOMER menerima Unit dan berakhir mengikuti akhir masa sewa.

CUSTOMER wajib menanggung beban biaya Risiko Sendiri (Own Risk/Deductible) yang ditentukan dalam dokumen asuransi untuk setiap klaim kerusakan Unit yang terjadi.

PASAL 8 ‚Äì KETENTUAN KHUSUS LAYANAN LEPAS KUNCI (SELF-OPERATED)
CUSTOMER wajib menandatangani atau menyetujui Lembar Pemeriksaan (Checklist) pada saat serah terima Unit.

CUSTOMER bertanggung jawab penuh atas segala tindakan pelanggaran lalu lintas atau regulasi di lokasi proyek yang dilakukan oleh Operator CUSTOMER selama menggunakan Unit.

Pengambilan dan pengembalian Unit mengacu pada lokasi dan jadwal yang disepakati bersama oleh PENYEDIA dan CUSTOMER.

PASAL 9 ‚Äì KETENTUAN LAIN-LAIN
Perjanjian ini tunduk pada hukum yang berlaku di Negara Republik Indonesia.

Dalam hal terjadi sengketa/perselisihan, maka akan diselesaikan melalui musyawarah mufakat. Jika tidak tercapai mufakat, Para Pihak sepakat menyelesaikannya di Pengadilan Negeri Jakarta Utara.

Demikian, Perjanjian ini dibuat oleh Para Pihak dan berlaku efektif serta mengikat sejak tanggal Reservasi telah dibayarkan oleh CUSTOMER.`;

    window.showTermsModal = () => {
      document.getElementById('termsContent').innerText = termsText;
      document.getElementById('termsModal').classList.remove('hidden');
    };

    window.closeTermsModal = () => {
      document.getElementById('termsModal').classList.add('hidden');
    };

    window.acceptTermsModal = () => {
      document.getElementById('chkTerms1').checked = true;
      closeTermsModal();
      checkTermsCheckboxes();
    };

    function checkTermsCheckboxes() {
      const chk1 = document.getElementById('chkTerms1').checked;
      const chk2 = document.getElementById('chkTerms2').checked;
      document.getElementById('btnContinuePayment').disabled = !(chk1 && chk2);
    }

    document.getElementById('chkTerms1').addEventListener('change', (e) => {
      if (e.target.checked) {
        showTermsModal();
      }
      checkTermsCheckboxes();
    });
    document.getElementById('chkTerms2').addEventListener('change', checkTermsCheckboxes);
  </script>
</MainLayout>